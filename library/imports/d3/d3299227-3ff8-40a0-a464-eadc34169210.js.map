{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\Jogador.js"],"names":["cc","Class","extends","Component","properties","_vidaAtual","Float","vidaMaxima","_direcao","Vec2","tiro","Prefab","_movimentacao","_controleAnimacao","_canvas","Canvas","_camera","Node","vivo","_audioTiro","AudioSource","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","teclaPressionada","KEY_UP","teclaSolta","getComponent","find","atirar","mudarDirecaoDaAnimcao","node","sofrerDano","update","deltaTime","setDirecao","andarPraFrente","eventoPerdeVida","Event","EventCustom","setUserData","vidaAtual","dispatchEvent","event","direcao","calcularDirecaoMouse","estado","mag","mudaAnimacao","posicaoMouse","getLocation","x","y","convertToNodeSpaceAR","posicaoJogadora","position","sub","disparo","instantiate","parent","play","keyCode","KEY","a","d","w","s"],"mappings":"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","file":"Jogador.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _vidaAtual : cc.Float,\n        vidaMaxima : cc.Float,\n        _direcao : cc.Vec2,\n        tiro : cc.Prefab,\n        _movimentacao : cc.Component,\n        _controleAnimacao : cc.Component,\n        _canvas : cc.Canvas,\n        _camera : cc.Node,\n        vivo : true,\n        _audioTiro : cc.AudioSource,\n\n    },\n\n\n    onLoad: function () {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.teclaPressionada, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.teclaSolta, this);\n        this._movimentacao = this.getComponent(\"Movimentacao\");\n        this._controleAnimacao = this.getComponent(\"ControleDeAnimacao\");\n        this._audioTiro = this.getComponent(cc.AudioSource);\n        this._canvas = cc.find(\"Canvas\");\n        this._canvas.on(\"mousedown\", this.atirar, this);\n        this._canvas.on(\"mousemove\", this.mudarDirecaoDaAnimcao, this);\n        this._camera = cc.find(\"Camera\");\n        this.vivo = true;\n        this.node.on(\"SofreDano\", this.sofrerDano, this);\n        this._vidaAtual = this.vidaMaxima;\n    },\n    \n    update: function (deltaTime) {\n        this._movimentacao.setDirecao(this._direcao);\n        this._movimentacao.andarPraFrente();\n\n    },\n    \n    sofrerDano: function(){\n        this._vidaAtual = 1;\n        let eventoPerdeVida = new cc.Event.EventCustom(\"JogadoraPerdeuVida\", true);\n        eventoPerdeVida.setUserData({vidaAtual : this._vidaAtual ,  vidaMaxima : this.vidaMaxima});\n        this.node.dispatchEvent(eventoPerdeVida);\n        if(this._vidaAtual <0){\n            this.vivo = false;\n        }\n    },\n\n    mudarDirecaoDaAnimcao : function(event){\n        let direcao = this.calcularDirecaoMouse(event);\n        let estado;\n        if(this._direcao.mag() == 0){\n            estado = \"Parado\";\n        }else{\n            estado = \"Andar\";\n        }\n        this._controleAnimacao.mudaAnimacao(direcao, estado);\n    },\n\n    calcularDirecaoMouse : function(event){\n        let posicaoMouse = event.getLocation();\n        posicaoMouse = new cc.Vec2(posicaoMouse.x, posicaoMouse.y);\n        posicaoMouse = this._canvas.convertToNodeSpaceAR(posicaoMouse);\n        let posicaoJogadora = this._camera.convertToNodeSpaceAR(this.node.position);\n        \n        let direcao = posicaoMouse.sub(posicaoJogadora);\n        return direcao;\n    },\n\n    atirar : function(event){\n        let direcao = this.calcularDirecaoMouse(event);\n        let disparo = cc.instantiate(this.tiro);  \n        disparo.parent = this.node.parent;\n        disparo.position = this.node.position;\n        disparo.getComponent(\"Movimentacao\").setDirecao(direcao);\n        \n        this._audioTiro.play();\n    },\n\n    teclaPressionada : function(event){\n\n        if(event.keyCode == cc.KEY.a){\n            this._direcao.x = -1;\n        }\n        if(event.keyCode == cc.KEY.d){\n            this._direcao.x = 1;\n        }\n\n        if(event.keyCode == cc.KEY.w){\n            this._direcao.y = 1;\n        }\n        if(event.keyCode == cc.KEY.s){\n            this._direcao.y = -1;\n        }\n    },\n\n\n    teclaSolta : function(event){\n        if(event.keyCode == cc.KEY.a){\n            this._direcao.x = 0;\n        }\n        if(event.keyCode == cc.KEY.d){\n            this._direcao.x = 0;\n        }\n\n        if(event.keyCode == cc.KEY.w){\n            this._direcao.y = 0;\n        }\n        if(event.keyCode == cc.KEY.s){\n            this._direcao.y = 0;\n        }\n    }\n\n});\n"]}