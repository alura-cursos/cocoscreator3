{"version":3,"sources":["Jogador.js"],"names":["cc","Class","extends","Component","properties","_vidaAtual","Float","vidaMaxima","_direcao","Vec2","tiro","Prefab","_movimentacao","_controleAnimacao","_canvas","Canvas","_camera","Node","vivo","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","teclaPressionada","KEY_UP","teclaSolta","getComponent","find","atirar","mudarDirecaoDaAnimcao","node","sofrerDano","update","deltaTime","setDirecao","andarPraFrente","eventoPerdeVida","Event","EventCustom","setUserData","vidaAtual","dispatchEvent","event","direcao","calcularDirecaoMouse","estado","mag","mudaAnimacao","posicaoMouse","getLocation","x","y","convertToNodeSpaceAR","posicaoJogadora","position","sub","disparo","instantiate","parent","keyCode","KEY","a","d","w","s"],"mappings":"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","file":"Jogador.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _vidaAtual : cc.Float,\n        vidaMaxima : cc.Float,\n        _direcao : cc.Vec2,\n        tiro : cc.Prefab,\n        _movimentacao : cc.Component,\n        _controleAnimacao : cc.Component,\n        _canvas : cc.Canvas,\n        _camera : cc.Node,\n        vivo : true,\n\n    },\n\n\n    onLoad: function () {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.teclaPressionada, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.teclaSolta, this);\n        this._movimentacao = this.getComponent(\"Movimentacao\");\n        this._controleAnimacao = this.getComponent(\"ControleDeAnimacao\");\n        this._canvas = cc.find(\"Canvas\");\n        this._canvas.on(\"mousedown\", this.atirar, this);\n        this._canvas.on(\"mousemove\", this.mudarDirecaoDaAnimcao, this);\n        this._camera = cc.find(\"Camera\");\n        this.vivo = true;\n        this.node.on(\"SofreDano\", this.sofrerDano, this);\n        this._vidaAtual = this.vidaMaxima;\n    },\n    \n    update: function (deltaTime) {\n        this._movimentacao.setDirecao(this._direcao);\n        this._movimentacao.andarPraFrente();\n\n    },\n    \n    sofrerDano: function(){\n        this._vidaAtual -= 1;\n        let eventoPerdeVida = new cc.Event.EventCustom(\"JogadoraPerdeuVida\", true);\n        eventoPerdeVida.setUserData({vidaAtual : this._vidaAtual ,  vidaMaxima : this.vidaMaxima});\n        this.node.dispatchEvent(eventoPerdeVida);\n        if(this._vidaAtual <0){\n            this.vivo = false;\n        }\n    },\n\n    mudarDirecaoDaAnimcao : function(event){\n        let direcao = this.calcularDirecaoMouse(event);\n        let estado;\n        if(this._direcao.mag() == 0){\n            estado = \"Parado\";\n        }else{\n            estado = \"Andar\";\n        }\n        this._controleAnimacao.mudaAnimacao(direcao, estado);\n    },\n\n    calcularDirecaoMouse : function(event){\n        let posicaoMouse = event.getLocation();\n        posicaoMouse = new cc.Vec2(posicaoMouse.x, posicaoMouse.y);\n        posicaoMouse = this._canvas.convertToNodeSpaceAR(posicaoMouse);\n        let posicaoJogadora = this._camera.convertToNodeSpaceAR(this.node.position);\n        \n        let direcao = posicaoMouse.sub(posicaoJogadora);\n        return direcao;\n    },\n\n    atirar : function(event){\n        let direcao = this.calcularDirecaoMouse(event);\n        let disparo = cc.instantiate(this.tiro);  \n        disparo.parent = this.node.parent;\n        disparo.position = this.node.position;\n        disparo.getComponent(\"Movimentacao\").setDirecao(direcao);\n    },\n\n    teclaPressionada : function(event){\n\n        if(event.keyCode == cc.KEY.a){\n            this._direcao.x = -1;\n        }\n        if(event.keyCode == cc.KEY.d){\n            this._direcao.x = 1;\n        }\n\n        if(event.keyCode == cc.KEY.w){\n            this._direcao.y = 1;\n        }\n        if(event.keyCode == cc.KEY.s){\n            this._direcao.y = -1;\n        }\n    },\n\n\n    teclaSolta : function(event){\n        if(event.keyCode == cc.KEY.a){\n            this._direcao.x = 0;\n        }\n        if(event.keyCode == cc.KEY.d){\n            this._direcao.x = 0;\n        }\n\n        if(event.keyCode == cc.KEY.w){\n            this._direcao.y = 0;\n        }\n        if(event.keyCode == cc.KEY.s){\n            this._direcao.y = 0;\n        }\n    }\n\n});\n"]}